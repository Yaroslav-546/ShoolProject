<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Новости{% endblock title %}</title>
    <link rel="icon" type="image/png" href="{% static 'Images/main-icon.svg' %}" type="image/svg+xml"/>
    <link href="{% static 'css/base.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/fancybox/fancybox.css"
    />
</head>

<body class="{% block body_class %}{% endblock %}">
    {% block header %}
    <header>
        <nav class="navbar navbar-expand-lg bg-body-tertiary" id="mn-navbar">
            <div class="container-fluid">
                <a href="{% url 'index' %}" class="d-flex align-items-center text-decoration-none">
                    <img src="{% static 'Images/main-icon.svg' %}" alt="icon" id="logo-image" style="width: 40px; height: 40px; object-fit: contain;">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav" id="nav-bar">
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'index' %}">Главная</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'news' %}">Новости</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'activities' %}">Кружки</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'achievements' %}">Достижения</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'gallery' %}">Галерея</a>
                        </li>

                        {% if user.is_superuser %}
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'post_new' %}">Добавить Новости</a>
                        </li>
                        {% endif %}

                        {% if user.is_superuser %}
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'studentslist' %}">Ученики</a>
                        </li>
                        {% endif %}

                        {% if user.is_authenticated %}
                        <li class="nav-item mobile-only">
                            <a class="nav-link" href="{% url 'dashboard' %}">
                                Личный кабинет
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                    <ul class="navbar-nav ms-auto mg-r-main" id="navbarNav">
                        {% if user.is_authenticated %}
                        <li class="nav-item desktop-only">
                            <a aria-current="page" href="{% url 'dashboard' %}"><img src="{{ user.avatar.url }}" alt="Аватар" class="user-avatar" onerror="this.src='/media/users/default_avatar.png'"></a>
                        </li>
                        {% else %}
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'login' %}">Войти</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="{% url 'register' %}">Регистрация</a>
                        </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    {% endblock header %}
    {% block content %}

    {% endblock content %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

    <script>
        (function () {
	        var a = document.querySelectorAll('.navbar-nav a');
		        for (var i=a.length; i--;) {
			        if (a[i].href === window.location.pathname || a[i].href === window.location.href) a[i].className += ' active';
		        }
        })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.0/dist/fancybox/fancybox.umd.js"></script>
    <script>
        Fancybox.bind("[data-fancybox]", {
            Carousel: {
                Zoomable: {
                Panzoom: {
                    clickAction: "iterateZoom",
                    maxScale: 2,
                },
            },
        },
    });
    </script>
    <canvas id="windSnow"></canvas>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const canvas = document.getElementById('windSnow');
        const ctx = canvas.getContext('2d');

        let width = window.innerWidth;
        let height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;

        // Настройки снега
        const snowflakes = [];
        const maxSnowflakes = 200;
        let windForce = 0;
        let windDirection = 1;

        class SnowParticle {
            constructor() {
                this.reset();
            }

            reset() {
                this.x = Math.random() * width;
                this.y = Math.random() * -height;
                this.size = Math.random() * 3 + 1;
                this.speed = Math.random() * 1 + 0.5;
                this.wind = (Math.random() - 0.5) * 0.5;
                this.opacity = Math.random() * 0.5 + 0.3;
                this.swing = Math.random() * Math.PI * 2;
                this.swingSpeed = Math.random() * 0.05 + 0.02;
            }

            update() {
                this.y += this.speed;
                this.x += this.wind + windForce * windDirection;
                this.swing += this.swingSpeed;
                this.x += Math.sin(this.swing) * 0.5;

                if (this.y > height) {
                    this.reset();
                    this.y = -10;
                }

                if (this.x > width + 10) {
                    this.x = -10;
                } else if (this.x < -10) {
                    this.x = width + 10;
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                ctx.fill();
            }
        }

        for (let i = 0; i < maxSnowflakes; i++) {
            snowflakes.push(new SnowParticle());
        }

        function updateWind() {
            windForce = (Math.random() - 0.5) * 0.3;
            if (Math.random() > 0.98) {
                windDirection *= -1;
            }
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);

            updateWind();

            snowflakes.forEach(particle => {
                particle.update();
                particle.draw();
            });

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', function() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        });

        const currentMonth = new Date().getMonth();
        if (currentMonth === 11 || currentMonth === 0 || currentMonth === 1) {
            animate();
        }
    });
    </script>

</body>

</html>